---
title: "STA360 Final Project"
author: 
- Martin Lim
- Michael Xue
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(cowplot)
```

```{r echo=FALSE}
data <- read.csv("data.csv")
data <- filter(data, country!="(nu")
```

```{r echo=FALSE}
data <- mutate(data, extraversion = E1 + (6-E2) + E3 + (6-E4) + E5 + (6-E6) + E7 + (6-E8) + E9 + (6-E10))
data <- mutate(data, agreeableness = (6-A1) + A2 + (6-A3) + A4 + (6-A5) + A6 + (6-A7) + A8 + A9 + A10)
data <- mutate(data, conscientiousness = C1 + (6-C2) + C3 + (6-C4) + C5 + (6-C6) + C7 + (6-C8) + C9 + C10)
data <- mutate(data, emotional_stability = (6-N1) + N2 + (6-N3) + N4 + (6-N5) + (6-N6) + (6-N7) + (6-N8) + (6-N9) + 6-N10)
data <- mutate(data, intellect = O1 + (6-O2) + O3 + (6-O4) + O5 + (6-O6) + O7 + O8 + O9 + O10)
```

```{r echo=FALSE, eval=FALSE}
h1 <- ggplot(data, aes(x=extraversion)) +
  geom_histogram(binwidth=2)
h2 <- ggplot(data, aes(x=agreeableness)) +
  geom_histogram(binwidth=2)
h3 <- ggplot(data, aes(x=conscientiousness)) +
  geom_histogram(binwidth=2)
h4 <- ggplot(data, aes(x=emotional_stability)) +
  geom_histogram(binwidth=2)
h5 <- ggplot(data, aes(x=intellect)) +
  geom_histogram(binwidth=2)
title <- ggdraw() + 
  draw_label("Distribution of Scores for Each Factor",
             fontface="bold",
             x = 0,
             hjust=0) +
  theme(plot.margin = margin(0, 0, 0, 7))
p <- plot_grid(h1, h2, h3, h4, h5)
plot_grid(title, p, ncol=1, rel_heights = c(0.1, 1))
```

```{r echo=FALSE, warning=FALSE, results="hide", include=FALSE}
data %>%
  group_by(country) %>%
  count(country) %>%
  arrange(desc(n))

install.packages("jsonlite", repos="https://cran.rstudio.com/")
library("jsonlite")

json_file <- 'https://datahub.io/JohnSnowLabs/country-and-continent-codes-list/datapackage.json'
json_data <- fromJSON(paste(readLines(json_file), collapse=""))

# get list of all resources:
print(json_data$resources$name)

# print all tabular data(if exists any)
for(i in 1:length(json_data$resources$datahub$type)){
  if(json_data$resources$datahub$type[i]=='derived/csv'){
    path_to_file = json_data$resources$path[i]
    isodata <- read.csv(url(path_to_file))
    isodata <- replace_na(isodata, list(Continent_Code="NA"))
    colnames(isodata)[4] <- "country"
  }
}
```

```{r echo=FALSE}
fulldata <- merge(data, isodata, by=c("country"))
#subset(fulldata, select=-c(Country_Name, Country_Number, Three_Letter_Country_Code, Continent_Name))
fulldata <- subset(fulldata, select=c(Continent_Code, extraversion, agreeableness, conscientiousness, emotional_stability, intellect))
colnames(fulldata)[1] <- "continent"
```


# Introduction
The Big Five personality trait model was developed by various individual researchers. In 1936, Gordon Allport and Henry Odbert formed a list of 4,500 terms relating to personality traits, providing the foundation for other psychologists to start investigating the basic dimensions of personality. Using factor analysis, this list was eventually narrowed down to five key personality traits, which became known as the "Big Five". Each of these five traits actually encompasses a multitude of other traits. For example, extraversion is an aggregate of gregariousness, assertiveness, activity, excitement-seeking, positive emotions, and warmth. Another key aspect of this Big Five model is that it classifies personality traits on a spectrum, rather than into specific categories. The Big Five traits are not associated with any particular personality test, as there are several different ways to measure these traits. Our project focuses on specifically on the Big-Five Factor Markers from the International Personality Item Pool developed by Lewis R. Goldberg. 

The goal of this project is to  

# Data
The data comes from the Open-Source Psychometrics Project, which provides a collection of interactive personality tests. The data was collected in 2012 through an online personality test of the Big-Five Factor Markers from the International Personality Item Pool on the Open-Source Psychometrics Project website. Prior to starting the test, participants were informed that their responses would be recorded and used for research purposes, and consent to record their responses was confirmed after the test. This dataset contains 57 variables: 50 of these variables are the participants' answers to the 50 question Big Five personality test and 7 of these variables are additional demographic information about the participant. The participants answer the 50 questions on a scale of 1 to 5; 1 means that the participant finds the statement "Very Inaccurate", 3 means that the statement is "Neither Accurate Nor Inaccurate", and 5 means that the statement is "Very Accurate". The 7 demographic variables that are not factored into the personality test are: race, age, gender, handedness, the participant's country location, how the participant came to the test, and whether English is the participant's native language. The Big Five factors that this 50 question test measures are "extraversion", "agreeableness", "conscientiousness", "emotional stability", and "intellect". Each question on the test corresponds to only one of these factors, and each factor is defined by 10 questions. 

The original dataset included 19719 observations, but 378 observations were removed as they were missing the country variables. Given that each observation is the result of just one participant, removing these observations should not have any significant impact on our findings. From the 50 questions, additional variables were created to store the scores received in each of the Big Five factors. Scoring for the factors is computed as follows: each question corresponds to a single factor and is "+keyed" or "-keyed". For "+keyed" items, the response "Very Inaccurate" is assigned a value of 1, "Moderately Inaccurate" a value of 2, "Neither Inaccurate nor Accurate" a 3, "Moderately Accurate" a 4, and "Very Accurate" a value of 5. For "-keyed" items, the response "Very Inaccurate" is assigned a value of 5, "Moderately Inaccurate" a value of 4, "Neither Inaccurate nor Accurate" a 3, "Moderately Accurate" a 2, and "Very Accurate" a value of 1. Once values are calculated for each question, they should be summed to obtain the total score for that factor. Each factor can have a different number of ("+keyed", "-keyed") questions: extraversion (5, 5), agreeableness (6, 4), conscientiousness (6, 4), emotional stability (2, 8), intellect (3, 7). After obtaining a score for each factor on each observation, we found that scores were normally distributed for each factor, with agreeableness and intellect being a little left skewed. 

```{r echo=FALSE}
h1 <- ggplot(data, aes(x=extraversion)) +
  geom_histogram(binwidth=2)
h2 <- ggplot(data, aes(x=agreeableness)) +
  geom_histogram(binwidth=2)
h3 <- ggplot(data, aes(x=conscientiousness)) +
  geom_histogram(binwidth=2)
h4 <- ggplot(data, aes(x=emotional_stability)) +
  geom_histogram(binwidth=2)
h5 <- ggplot(data, aes(x=intellect)) +
  geom_histogram(binwidth=2)
title <- ggdraw() + 
  draw_label("Distribution of Scores for Each Factor",
             x = 0,
             hjust=0) +
  theme(plot.margin = margin(0, 0, 0, 7))
p <- plot_grid(h1, h2, h3, h4, h5)
plot_grid(title, p, ncol=1, rel_heights = c(0.1, 1))
```

To find the continent codes for each country, we imported a data frame from an outside source mapping country code to the corresponding continent code. We merged the two data frames together and selected only the necessary variables. The continents represented in the final data are North America (NA), Europe (EU), Asia (AS), Oceania (OC), Africa (AF), and South America (SA). 

```{r }
cont_counts <- fulldata %>%
  group_by(continent) %>%
  count(continent) %>%
  arrange(desc(n))
colnames(cont_counts) <- c("Continent", "Count")
print.data.frame(cont_counts)
```


# Modeling

# Results

# Conclusion





